MACRO
NO3 X.1-X.M
MCONSTANT N.1-N.M NDATA I J rata.1-rata.M DUMMY
MCOLUMN X.1-X.M DUMX.1-DUMX.M CDUMMY CT CDUM4
MMATRICES Y YT COV COVT MDUM1 MDUM2 MDUM3 MDUM4

LET NDATA = COUNT(X.1)
DO I = 1:M
	LET N.I = COUNT(X.I)
	LET rata.I = MEAN(X.I)
ENDDO

DO I = 1:M
	DO J = 1:N.I
		LET DUMX.I(J) = X.I(J) - rata.1
	ENDDO
ENDDO

# POIN A
COPY DUMX.1-DUMX.M Y
PRINT Y 

# POIN B
TRANS Y YT
MULT YT Y COV
LET DUMMY = 1/(NDATA-1)
MULT DUMMY COV COV
PRINT COV

# POIN C
INVE COV COVT
DO I = 1:NDATA
	DO J = 1:M
		LET CDUMMY(J) = X.J(I)
	ENDDO
	COPY CDUMMY MDUM1 #MDUM1 YITRANSPOSE
	TRANS MDUM1 MDUM2 #MDUM2 YI
	MULT MDUM2 COVT MDUM3 #MDUM3 YI SIGMAINV
	MULT MDUM3 MDUM1 MDUM4 #MDUM4 YI SIGMAINV YITRANSPOSE
	COPY MDUM4 CDUM4
	LET CT(I) = CDUM4(1)
ENDDO

# POIN D
PRINT CT
ENDMACRO

